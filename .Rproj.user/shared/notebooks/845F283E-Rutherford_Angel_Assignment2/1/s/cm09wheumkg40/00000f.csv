"0","# Spatial join tracts to counties"
"0","vulnerable_distance <- st_transform(vulnerable_distance, st_crs(pa_counties))"
"0",""
"0","tracts_per_county <- vulnerable_distance %>% "
"0","  st_join(pa_counties) %>%"
"0","  st_drop_geometry() %>%"
"0","  group_by(COUNTY_NAM)"
"0",""
"0",""
"0","# Aggregate statistics by county"
"0","county_vulnerability <- tracts_per_county %>%"
"0","  summarise("
"0","    num_of_tracts = n(),"
"0","    num_of_underserved = sum(distance_to_nearest > 79200, na.rm = TRUE),"
"0","    pct_underserved =  num_of_underserved/num_of_tracts *100,"
"0","    avg_distance = mean(distance_to_nearest, na.rm = TRUE),"
"0","    total_vulnerable = sum(total_popE, na.rm = TRUE)"
"0","  )%>%"
"0","  arrange(desc(avg_distance))"
"0",""
"0","formated_county_vulnerability <- county_vulnerability%>%"
"0","  mutate("
"0","    total_vulnerable = comma(total_vulnerable),"
"0","    avg_distance = comma(avg_distance),"
"0","    pct_underserved = percent(pct_underserved/100)"
"0","  )"
"0",""
"0","formated_county_vulnerability%>%  "
"0","  select(COUNTY_NAM, num_of_underserved, num_of_tracts, pct_underserved, avg_distance, total_vulnerable)%>%"
"0","    kable("
"0","      col.names = c("
"0","""County Name"", ""Number of Underserved Tracts"","
"0","""Total Number of Vulnerable Tracts"", ""Percentage Underserved"", ""Average Distance"", ""Total Vulnerable Population""),"
"0","     digits=c(0,1,1,1,1))"
